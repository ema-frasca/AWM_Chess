(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{1:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return b})),n.d(t,"d",(function(){return E}));var a=n(2),i=n(3),r=n(5),l=n(4),c=n(6),s=n(0),o=n.n(s),u=function(t){function n(t){var i;return Object(a.a)(this,n),(i=Object(r.a)(this,Object(l.a)(n).call(this,t))).wsChange=function(){e.ws?i.setState({loading:!1}):i.setState({loading:!0})},i.state={loading:!0},i}return Object(c.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){this.wsChange(),e.wsOnStateChange.push(this.wsChange)}},{key:"render",value:function(){var t=this.state.loading?"loading-socket":"hidden";return o.a.createElement("div",{className:t},o.a.createElement("img",{className:"loading-icon",src:e.imgs+"loading.png",alt:"loading"}))}}]),n}(o.a.Component),m={empty:"empty",k:"black_king",q:"black_queen",b:"black_bishop",n:"black_knight",r:"black_rook",p:"black_pawn",K:"white_king",Q:"white_queen",B:"white_bishop",N:"white_knight",R:"white_rook",P:"white_pawn"};function d(t){var n="chess-piece ";t.className&&(n+=t.className);var a=e.sprites+m[t.piece]+".png";return o.a.createElement("img",{className:n,alt:t.piece,src:a})}function h(t){return o.a.createElement("div",{className:t.loading?"loading-page":"hidden"},o.a.createElement("img",{className:"loading-icon",src:e.imgs+"loading.png",alt:"loading"}))}function p(t){for(var n=0;e.wsOnMessage.has(n);n++);return e.wsOnMessage.set(n,t),n}function f(t){e.wsOnMessage.delete(t)}function b(e){return parseInt(e/60).toString().padStart(2,"0")+":"+(e%60).toString().padStart(2,"0")}var E=function(t){function n(e){var t;return Object(a.a)(this,n),(t=Object(r.a)(this,Object(l.a)(n).call(this,e))).tick=function(){var e=t.state.time-1;t.setState({time:e})},t.state={time:e.time},t.timer=null,t}return Object(c.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.tick,6e4)}},{key:"componentDidUpdate",value:function(e){e.updateTime!==this.props.updateTime&&this.setState({time:this.props.time})}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){var t=Math.max(0,this.state.time);return 0===t&&e.wsSend({type:"times-check"}),o.a.createElement("span",null,b(t))}}]),n}(o.a.Component)}).call(this,n(12))},20:function(e,t,n){"use strict";(function(e){var a=n(16),i=n(2),r=n(3),l=n(5),c=n(4),s=n(6),o=n(0),u=n.n(o),m=n(9),d=n(13),h=n(1),p=function(t){function n(e){var t;return Object(i.a)(this,n),(t=Object(l.a)(this,Object(c.a)(n).call(this,e))).getLeftMatches=function(e){e.quick===t.props.quick&&t.setState({leftMatches:e.number,redirectId:e.redirect,loading:!1})},t.userMatchesLeft={type:"matches-left",f:t.getLeftMatches,reqId:null},t.state={leftMatches:null,redirectId:null,loading:!0},t}return Object(s.a)(n,t),Object(r.a)(n,[{key:"componentDidMount",value:function(){this.userMatchesLeft.reqId=Object(h.e)(this.userMatchesLeft),e.wsSend({type:this.userMatchesLeft.type,quick:this.props.quick})}},{key:"componentWillUnmount",value:function(){Object(h.g)(this.userMatchesLeft.reqId)}},{key:"render",value:function(){if(this.state.loading)return u.a.createElement(h.a,{loading:!0});var e=this.props.quick;return e&&0===this.state.leftMatches&&this.state.redirectId?u.a.createElement(m.a,{to:"/game/"+this.state.redirectId}):u.a.createElement("div",null,this.state.leftMatches?u.a.createElement(b,{quick:e}):u.a.createElement(f,{quick:e}),u.a.createElement("hr",null),u.a.createElement(E,{leftMatches:this.state.leftMatches,quick:e}))}}]),n}(u.a.Component);function f(e){return u.a.createElement("p",null,"You have reached the maximum number of concurrent games (lobbies included) for ",e.quick?"quick":"slow"," games")}var b=function(t){function n(t){var a;return Object(i.a)(this,n),(a=Object(l.a)(this,Object(c.a)(n).call(this,t))).sendRequest=function(){e.wsSend({type:a.lobbiesRequest.type,quick:a.props.quick})},a.getLobbies=function(e){e.quick===a.props.quick&&a.setState({lobbies:e.lobbies,loading:!1})},a.lobbiesRequest={type:"matches-lobbies",f:a.getLobbies,reqId:null},a.state={lobbies:null,loading:!0},a}return Object(s.a)(n,t),Object(r.a)(n,[{key:"componentDidMount",value:function(){this.lobbiesRequest.reqId=Object(h.e)(this.lobbiesRequest),this.sendRequest()}},{key:"componentWillUnmount",value:function(){Object(h.g)(this.lobbiesRequest.reqId)}},{key:"render",value:function(){return this.state.loading?u.a.createElement(h.a,{loading:!0}):u.a.createElement("div",null,this.state.lobbies.length?null:u.a.createElement("p",null,"There are no existing game yet"),this.state.lobbies.map((function(e,t){return u.a.createElement(v,Object.assign({},e,{key:t}))})),u.a.createElement("button",{onClick:this.sendRequest},"Update"))}}]),n}(u.a.Component),E=function(t){function n(e){var t;return Object(i.a)(this,n),(t=Object(l.a)(this,Object(c.a)(n).call(this,e))).getMyLobby=function(e){e.quick===t.props.quick&&t.setState({myLobby:e.lobby,options:e.options,loading:!1})},t.myLobbyRequest={type:"matches-mylobby",f:t.getMyLobby,reqId:null},t.state={myLobby:null,options:null,loading:!0},t}return Object(s.a)(n,t),Object(r.a)(n,[{key:"componentDidMount",value:function(){this.myLobbyRequest.reqId=Object(h.e)(this.myLobbyRequest),e.wsSend({type:this.myLobbyRequest.type,quick:this.props.quick})}},{key:"componentWillUnmount",value:function(){Object(h.g)(this.myLobbyRequest.reqId)}},{key:"render",value:function(){if(this.state.loading)return u.a.createElement(h.a,{loading:!0});var e=this.state.myLobby;return!1===e&&0===this.props.leftMatches?null:u.a.createElement("div",null,e?u.a.createElement(y,e):u.a.createElement(g,{quick:this.props.quick,options:this.state.options}))}}]),n}(u.a.Component),g=function(t){function n(t){var r;return Object(i.a)(this,n),(r=Object(l.a)(this,Object(c.a)(n).call(this,t))).toggleEdit=function(e){var t=!r.state.onEdit;r.setState({onEdit:t})},r.handleChange=function(e){r.setState(Object(a.a)({},e.target.name,e.target.value))},r.handleSubmit=function(t){t.preventDefault(),e.wsSend({type:r.createMsg.type,quick:r.props.quick,color:r.state.color,time:parseInt(r.state.time)})},r.createMsg={type:"matches-create",quick:t.quick},r.state={onEdit:!1,color:t.options.colors[0],time:t.options.times[0]},r}return Object(s.a)(n,t),Object(r.a)(n,[{key:"render",value:function(){var e=this.state.onEdit?"cancel":"Create game",t=this.props.quick?"Total time per player":"Time per move",n=this.props.options;return u.a.createElement("div",null,u.a.createElement("button",{onClick:this.toggleEdit},e),u.a.createElement("form",{onSubmit:this.handleSubmit,className:this.state.onEdit?"":"hidden"},u.a.createElement("table",null,u.a.createElement("tbody",null,u.a.createElement("tr",null,u.a.createElement("td",null,"Chess pieces: "),u.a.createElement("td",null,u.a.createElement("select",{name:"color",value:this.state.color,onChange:this.handleChange},n.colors.map((function(e,t){return u.a.createElement("option",{value:e,key:t,className:"select-items"},e)}))))),u.a.createElement("tr",null,u.a.createElement("td",null,t,": "),u.a.createElement("td",null,u.a.createElement("select",{name:"time",value:this.state.time,onChange:this.handleChange},n.times.map((function(e,t){return u.a.createElement("option",{value:e,key:t},e," ",n.unit)}))))))),u.a.createElement("button",{type:"submit"},"enter")))}}]),n}(u.a.Component);function v(e){return u.a.createElement(d.b,{to:"/game/"+e.id,className:"lobby-link"},u.a.createElement(k,e))}function y(t){return u.a.createElement("div",{style:{display:"flex"}},u.a.createElement(k,t),u.a.createElement("button",{onClick:function(n){e.wsSend({type:"matches-delete",id:t.id,quick:t.quick})}},"delete"))}function k(e){var t,n,a,i=null,r=null;return"black"in e?(t=e.black.username,n=e.black.category,i=u.a.createElement(h.c,{piece:"k"})):(t=e.white.username,n=e.white.category,i=u.a.createElement(h.c,{piece:"K"})),!0===e.random&&(r="Chess pieces: random",i=null),a=e.quick?e.time+" minutes":e.time/60+" hours",u.a.createElement("div",{className:"lobby-box"},u.a.createElement("p",null,u.a.createElement("span",null,t),u.a.createElement("span",null,"(",n,")"),i,u.a.createElement("span",null,a)),u.a.createElement("h6",null,r))}t.a=p}).call(this,n(12))},24:function(e,t,n){"use strict";(function(e){var a=n(2),i=n(3),r=n(5),l=n(4),c=n(6),s=n(0),o=n.n(s),u=n(13),m=n(9),d=n(25),h=n(20),p=n(28),f=n(29),b=n(1),E=[{text:"HOME",url:"/",component:o.a.createElement(d.a,null)},{text:"QUICK\xa0GAME",url:"/quick",component:o.a.createElement(h.a,{quick:!0})},{text:"SLOW\xa0GAME",url:"/slow",component:o.a.createElement(h.a,{quick:!1})},{text:"ACCOUNT",url:"/user",component:o.a.createElement(p.a,null)}];function g(){return o.a.createElement(u.a,null,o.a.createElement(v,null),o.a.createElement("div",{id:"content"},o.a.createElement(m.d,null,o.a.createElement(m.b,{path:"/game/:id"},o.a.createElement(f.a,null)),E.slice().reverse().map((function(e,t){return o.a.createElement(m.b,{path:e.url,key:t},e.component)})))))}function v(){return o.a.createElement("div",{id:"main-menu"},E.map((function(e,t){return o.a.createElement(y,Object.assign({},e,{key:t}))})),o.a.createElement("h3",null,o.a.createElement("a",{href:"/account/logout"},"EXIT")))}function y(e){var t="/"===e.url?o.a.createElement(k,null):null;return o.a.createElement("h3",null,o.a.createElement(u.b,{to:e.url},e.text,t))}var k=function(t){function n(t){var i;return Object(a.a)(this,n),(i=Object(r.a)(this,Object(l.a)(n).call(this,t))).requestPage=function(){e.wsSend({type:i.notificationRequest.type})},i.getNotification=function(e){i.setState({notifications:e.number})},i.onNotification=function(e){i.requestPage()},i.notificationListener={type:"notify",f:i.onNotification,notId:null},i.notificationRequest={type:"notifications",f:i.getNotification,reqId:null},i.state={notifications:0},i}return Object(c.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){this.notificationRequest.reqId=Object(b.e)(this.notificationRequest),this.notificationListener.notId=Object(b.e)(this.notificationListener),this.requestPage()}},{key:"componentWillUnmount",value:function(){Object(b.g)(this.notificationRequest.reqId),Object(b.g)(this.notificationListener.notId)}},{key:"render",value:function(){return o.a.createElement("span",{id:"notification"},this.state.notifications?this.state.notifications:null)}}]),n}(o.a.Component);t.a=function(){return o.a.createElement("div",null,o.a.createElement(g,null),o.a.createElement(b.b,null))}}).call(this,n(12))},25:function(e,t,n){"use strict";(function(e){var a=n(2),i=n(3),r=n(5),l=n(4),c=n(6),s=n(0),o=n.n(s),u=n(13),m=n(1),d=function(t){function n(t){var i;return Object(a.a)(this,n),(i=Object(r.a)(this,Object(l.a)(n).call(this,t))).requestPage=function(){e.wsSend({type:i.homeRequest.type})},i.getHome=function(e){i.setState({list:e.list,history:e.history,user:e.username,loading:!1})},i.onNotification=function(e){i.requestPage()},i.notificationListener={type:"notify",f:i.onNotification,notId:null},i.homeRequest={type:"home-page",f:i.getHome,reqId:null},i.state={list:null,user:null,history:null,loading:!0},i}return Object(c.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){this.homeRequest.reqId=Object(m.e)(this.homeRequest),this.notificationListener.notId=Object(m.e)(this.notificationListener),this.requestPage()}},{key:"componentWillUnmount",value:function(){Object(m.g)(this.homeRequest.reqId),Object(m.g)(this.notificationListener.notId)}},{key:"render",value:function(){return this.state.loading?o.a.createElement(m.a,{loading:!0}):o.a.createElement("div",null,o.a.createElement("h1",null,"Welcome ",this.state.user),this.state.list.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement(h,Object.assign({},e,{ended:!1})))})),o.a.createElement("hr",null),o.a.createElement("h2",null,"History"),this.state.history.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement(h,Object.assign({},e,{ended:!0})))})))}}]),n}(o.a.Component);function h(e){return o.a.createElement(u.b,{to:"/game/"+e.id,className:"lobby-link"},e.ended?o.a.createElement(f,e):o.a.createElement(p,e))}function p(e){return o.a.createElement("div",{className:"lobby-box"},o.a.createElement("p",null,"vs ",o.a.createElement("span",null,e.vs.username),o.a.createElement("span",null,"(",e.vs.category,")"),e.turn?o.a.createElement("b",null,"Your turn"):null,o.a.createElement(m.d,{time:e.time,updateTime:(new Date).getTime()})))}function f(e){return o.a.createElement("div",{className:"lobby-box"},o.a.createElement("p",null,"vs ",o.a.createElement("span",null,e.vs),o.a.createElement("span",null,e.result)))}t.a=d}).call(this,n(12))},28:function(e,t,n){"use strict";(function(e){var a=n(16),i=n(2),r=n(3),l=n(5),c=n(4),s=n(6),o=n(0),u=n.n(o),m=n(1),d=function(t){function n(e){var t;return Object(i.a)(this,n),(t=Object(l.a)(this,Object(c.a)(n).call(this,e))).getPageInfo=function(e){t.setState({user:e,loading:!1})},t.pageRequest={type:"account-page",f:t.getPageInfo,reqId:null},t.state={user:{},loading:!0},t}return Object(s.a)(n,t),Object(r.a)(n,[{key:"componentDidMount",value:function(){this.pageRequest.reqId=Object(m.e)(this.pageRequest),e.wsSend({type:this.pageRequest.type})}},{key:"componentWillUnmount",value:function(){Object(m.g)(this.pageRequest.reqId)}},{key:"render",value:function(){if(this.state.loading)return u.a.createElement(m.a,{loading:!0});var e=this.state.user;return u.a.createElement("div",null,u.a.createElement("h1",null,u.a.createElement(p,{field:"username",value:e.username,btnClass:"user"})),u.a.createElement("h2",null,"Rank: ",e.category," (",e.rank,")"),"Email: ",u.a.createElement(p,{field:"email",value:e.email}),this.state.user.google?u.a.createElement(h,null):u.a.createElement(f,null))}}]),n}(u.a.Component);function h(t){return u.a.createElement("p",{className:"with-icon"},u.a.createElement("img",{className:"inline",width:"10%",src:e.imgs+"google_account.png",alt:"google icon"}),"Google Account")}var p=function(t){function n(t){var a;return Object(i.a)(this,n),(a=Object(l.a)(this,Object(c.a)(n).call(this,t))).getError=function(e){e.field===a.props.field&&("error"in e?a.setState({error:e.error}):a.setState({onEdit:!1,error:null}))},a.handleSubmit=function(t){t.preventDefault();var n=!a.state.onEdit;n&&a.setState({text:a.props.value}),n?a.setState({onEdit:n}):e.wsSend({type:a.editRequest.type,field:a.props.field,value:a.state.text})},a.editRequest={type:"account-edit",f:a.getError,reqId:null},a.state={onEdit:!1,text:"",error:null},a}return Object(s.a)(n,t),Object(r.a)(n,[{key:"componentDidMount",value:function(){this.editRequest.reqId=Object(m.e)(this.editRequest)}},{key:"componentWillUnmount",value:function(){Object(m.g)(this.editRequest.reqId)}},{key:"render",value:function(){var e=this,t=this.props.value,n=this.props.value?"change ":"add ";return n+=this.props.field,this.state.onEdit&&(t=u.a.createElement("input",{type:"text",value:this.state.text,style:{width:3+this.state.text.length+"ch"},onChange:function(t){return e.setState({text:t.target.value})}}),n="enter"),u.a.createElement("form",{className:"inline",onSubmit:this.handleSubmit},t,u.a.createElement("button",{type:"submit",className:"edit-btn "+this.props.btnClass},n),u.a.createElement("div",{className:this.state.error?"form-msg red":"hidden"},this.state.error))}}]),n}(u.a.Component),f=function(t){function n(t){var r;return Object(i.a)(this,n),(r=Object(l.a)(this,Object(c.a)(n).call(this,t))).getResponse=function(e){"error"in e?r.setState({response:e.error,error:!0}):(setTimeout((function(){return window.location.replace("http://"+window.location.host)}),1e3),r.setState({onEdit:!1,error:!1,response:"Your password has been successfully changed"}))},r.handleChange=function(e){r.setState(Object(a.a)({},e.target.name,e.target.value))},r.handleSubmit=function(t){t.preventDefault();var n=!r.state.onEdit;!n&&(r.state.textOld||r.state.textNew1||r.state.textNew2)?e.wsSend({type:r.pswRequest.type,old:r.state.textOld,new1:r.state.textNew1,new2:r.state.textNew2}):r.setState({onEdit:n}),r.setState({textOld:"",textNew1:"",textNew2:"",error:!1,response:null})},r.pswRequest={type:"account-psw",f:r.getResponse,reqId:null},r.state={onEdit:!1,response:null,error:!1,textOld:"",textNew1:"",textNew2:""},r}return Object(s.a)(n,t),Object(r.a)(n,[{key:"componentDidMount",value:function(){this.pswRequest.reqId=Object(m.e)(this.pswRequest)}},{key:"componentWillUnmount",value:function(){Object(m.g)(this.pswRequest.reqId)}},{key:"render",value:function(){var e=this.state.onEdit?"enter":"change password";return u.a.createElement("form",{onSubmit:this.handleSubmit},u.a.createElement("button",{type:"submit"},e),u.a.createElement("div",{className:this.state.response?"form-msg "+(this.state.error?"red":"green"):"hidden"},this.state.response),u.a.createElement("table",{className:this.state.onEdit?"":"hidden"},u.a.createElement("tbody",null,u.a.createElement("tr",null,u.a.createElement("td",null,"Old password: "),u.a.createElement("td",null,u.a.createElement("input",{type:"password",name:"textOld",value:this.state.textOld,onChange:this.handleChange}))),u.a.createElement("tr",null,u.a.createElement("td",null,"New password: "),u.a.createElement("td",null,u.a.createElement("input",{type:"password",name:"textNew1",value:this.state.textNew1,onChange:this.handleChange}))),u.a.createElement("tr",null,u.a.createElement("td",null,"Confirm password: "),u.a.createElement("td",null,u.a.createElement("input",{type:"password",name:"textNew2",value:this.state.textNew2,onChange:this.handleChange}))),u.a.createElement("tr",null,u.a.createElement("td",{colSpan:"2"},"You will be redirect to login after a successful change")))))}}]),n}(u.a.Component);t.a=d}).call(this,n(12))},29:function(e,t,n){"use strict";(function(e){var a=n(2),i=n(3),r=n(5),l=n(4),c=n(6),s=n(0),o=n.n(s),u=n(9),m=n(1);var d=function(t){function n(t){var i;return Object(a.a)(this,n),(i=Object(r.a)(this,Object(l.a)(n).call(this,t))).requestPage=function(){e.wsSend({type:i.gameRequest.type,id:i.id})},i.getGame=function(e){e.id===i.id&&i.setState({game:e,loading:!1})},i.onNotification=function(e){e.id===i.id&&i.requestPage()},i.notificationListener={type:"notify",f:i.onNotification,notId:null},i.gameRequest={type:"game-page",f:i.getGame,reqId:null},i.id=parseInt(i.props.id),i.state={game:null,loading:!0},i}return Object(c.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){this.gameRequest.reqId=Object(m.e)(this.gameRequest),this.notificationListener.notId=Object(m.e)(this.notificationListener),this.requestPage()}},{key:"componentWillUnmount",value:function(){Object(m.g)(this.gameRequest.reqId),Object(m.g)(this.notificationListener.notId)}},{key:"render",value:function(){if(this.state.loading)return o.a.createElement(m.a,{loading:!0});var e=this.state.game;return"error"in e?o.a.createElement("p",null,e.error):"result"in e?o.a.createElement(h,e):o.a.createElement(b,e)}}]),n}(o.a.Component);function h(e){var t={white:"",black:""};return"White"===e.match.result?t={white:"Winner",black:"Loser"}:"Black"===e.match.result&&(t={white:"Loser",black:"Winner"}),o.a.createElement("div",null,o.a.createElement("div",{className:"game-container"},o.a.createElement(p,{user:e.match.black,result:t.black,piece:"k",turn:!e.match.whiteTurn}),o.a.createElement(y,{board:e.board,moves:{},id:e.id,whiteTurn:!1}),o.a.createElement(p,{user:e.match.white,result:t.white,piece:"K",turn:e.match.whiteTurn})),o.a.createElement(v,{pgn:e.match.pgn}),o.a.createElement(f,{result:e.result,reason:e.match.reason}))}function p(e){var t="result-line";return"Winner"===e.result&&(t+=" zooming"),o.a.createElement("div",null,o.a.createElement(g,{user:e.user,piece:e.piece,turn:!1}),o.a.createElement("p",{className:t},e.result))}function f(e){return o.a.createElement("div",{className:"moves-list"},o.a.createElement("h2",null,e.result),o.a.createElement("h4",null,"The match ended because of ",o.a.createElement("b",null,e.reason)))}function b(e){return o.a.createElement("div",null,o.a.createElement("div",{className:"game-container"},o.a.createElement(E,{user:e.match.black,time:e.match.time.black,piece:"k",turn:!e.match.whiteTurn}),o.a.createElement(y,{board:e.board,moves:e.moves,id:e.id,whiteTurn:e.match.whiteTurn}),o.a.createElement(E,{user:e.match.white,time:e.match.time.white,piece:"K",turn:e.match.whiteTurn}),o.a.createElement(k,{id:e.id,claim:e.claim})),o.a.createElement(v,{pgn:e.match.pgn}))}function E(e){return o.a.createElement("div",null,o.a.createElement(g,{user:e.user,piece:e.piece,turn:e.turn}),o.a.createElement("p",{className:"user-time"},e.turn?o.a.createElement(m.d,{time:e.time}):Object(m.f)(e.time)))}function g(e){return o.a.createElement("p",{className:"user-line"},o.a.createElement(m.c,{className:e.turn?"jumping":"",piece:e.piece}),o.a.createElement("span",null,e.user.username),o.a.createElement("span",null,"(",e.user.category,")"))}function v(e){return o.a.createElement("div",{className:"moves-list"},o.a.createElement("h3",null,"History"),o.a.createElement("div",null,e.pgn.map((function(e,t){return o.a.createElement("h5",{key:t},e)}))))}var y=function(t){function n(t){var i;return Object(a.a)(this,n),(i=Object(r.a)(this,Object(l.a)(n).call(this,t))).handleClick=function(t){i.state.selected&&t in i.props.moves[i.state.selected]?i.props.moves[i.state.selected][t].length?i.setState({promotion:t}):(e.wsSend({type:"game-move",move:i.state.selected+t,id:i.props.id}),i.setState({selected:null})):i.setState({selected:t})},i.promotionClick=function(t){t&&e.wsSend({type:"game-move",move:i.state.selected+i.state.promotion+t,id:i.props.id}),i.setState({selected:null,promotion:null})},i.buttonRender=function(e,t,n){var a=e+t,r=a in i.props.moves,l="";return i.state.selected&&a in i.props.moves[i.state.selected]&&(l="target",r=!0),o.a.createElement("td",{key:a},o.a.createElement("button",{id:a,name:a,disabled:!r,className:l,onClick:function(){return i.handleClick(a)}},o.a.createElement(m.c,{piece:n})," "))},i.state={selected:null,promotion:null},i.options=["q","b","n","r"],i.columns=["a","b","c","d","e","f","g","h"],i}return Object(c.a)(n,t),Object(i.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"board"},o.a.createElement("table",null,o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.state.promotion?o.a.createElement(O,{options:this.options,onClick:this.promotionClick,whiteColor:this.props.whiteTurn}):null),this.columns.map((function(e){return o.a.createElement("th",{key:e},e)}))),this.props.board.split("/").map((function(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return o.a.createElement("tr",{key:n},o.a.createElement("th",null,8-n),t.split("").map((function(t,a){var r=parseInt(t);if(r){for(var l=[],c=0;c<r;c++,i++)l.push(e.buttonRender(e.columns[a+i],8-n,"empty"));return i--,l}return e.buttonRender(e.columns[a+i],8-n,t)})))})))))}}]),n}(o.a.Component);function k(t){return o.a.createElement("div",{style:{clear:"both"}},o.a.createElement("button",{disabled:!t.claim,onClick:function(){return e.wsSend({type:"game-claim",id:t.id})}},"Claim Draw"),o.a.createElement("button",{onClick:function(){return e.wsSend({type:"game-resign",id:t.id})}},"Resign"))}var O=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(l.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),n.props.onClick(n.state.selected)},n.state={selected:e.options[0]},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"promotion"},o.a.createElement("form",{onSubmit:this.handleSubmit},this.props.options.map((function(t,n){return o.a.createElement("label",{key:n},o.a.createElement(m.c,{piece:e.props.whiteColor?t.toUpperCase():t}),o.a.createElement("input",{type:"radio",name:"promotion",value:t,checked:e.state.selected===t,onChange:function(t){return e.setState({selected:t.target.value})}}))})),o.a.createElement("br",null),o.a.createElement("input",{className:"button",type:"submit",value:"confirm"}),o.a.createElement("input",{className:"button",type:"button",value:"cancel",onClick:function(){return e.props.onClick(null)}})))}}]),t}(o.a.Component);t.a=function(){var e=Object(u.g)().id;return o.a.createElement(d,{id:e})}}).call(this,n(12))},30:function(e,t,n){e.exports=n(31)},31:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(23),l=n.n(r),c=n(24);n(40);l.a.render(i.a.createElement(c.a,null),document.getElementById("root"))},40:function(e,t,n){(function(e){e.static="/static/",e.imgs=e.static+"imgs/",e.sprites=e.static+"sprites/",e.ws=null,e.wsOnStateChange=[],e.wsOnMessage=new Map;var t=250;function n(t){e.ws=t,e.wsOnStateChange.forEach((function(e){return e()})),t&&function(){for(;a.length>0;){var t=a.pop();e.wsSend(t)}}()}i();var a=[];function i(){var a,i=new WebSocket("ws://"+window.location.host+"/ws");i.onopen=function(e){console.log("WebSocket connect"),t=250,clearTimeout(a),n(i)},i.onclose=function(e){console.log("WebSocket disconnect, error "+e.reason),n(null),t<5e3&&(t*=2),a=setTimeout(r,t)},i.onerror=function(e){i.close()},i.onmessage=function(t){var n=JSON.parse(t.data);e.wsOnMessage.forEach((function(e,t){e.type===n.type&&e.f(n)}))}}function r(){var t=e.ws;t&&t.readyState!==WebSocket.CLOSED||i()}e.wsSend=function(t){e.ws?e.ws.send(JSON.stringify(t)):a.push(t)}}).call(this,n(12))}},[[30,1,2]]]);
//# sourceMappingURL=main.0a81599b.chunk.js.map